{% extends 'layouts/base.html' %}
{% load static i18n humanize bootstrap4 custom_tags %}

{% block extracss %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'css/detail.css' %}"/>
{% endblock %}


{% block content %}
    <div class="row mb-4">
        <div class="col-md-8 col-12">
            <div class="clearfix" id="attachments_images"></div>
            <div class="overlay" id="spin-attachments-images">
                <i class="fas fa-2x fa-sync-alt fa-spin"></i>
            </div>
        </div>
        <div class="col-md-4 col-12 mt-4 mt-md-0">
            <div class="card col-12">
                <div class="card-header pb-0">
                    <h5 class="font-weight-bold mb-0">{% translate "Prefecture Overview" %}</h5>
                </div>
                <div class="card-body p-2">
                    <table class="table">
                        <tbody>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Total" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.total_population }}</td>
                        </tr>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Men" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.population_men }}</td>
                        </tr>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Women" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.population_women }}</td>
                        </tr>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Young" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.population_young }}</td>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Elder" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.population_elder }}</td>
                        </tr>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Handicap" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.population_handicap }}</td>
                        </tr>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Agruculture" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.population_agriculturist }}</td>
                        </tr>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Breeders" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.population_pastoralist }}</td>
                        </tr>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Minorities" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.population_minorities }}</td>
                        </tr>
                        <tr>
                            <td class="border-0 p-0 pl-2 text-left font-weight-bold">{% translate "Languages" %}</td>
                            <td class="border-0 p-0 pr-2 text-right">{{ object.main_languages }}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body table-responsive">
                    <div class="col-12">
                        <ul class="nav nav-tabs">
                            <li class="nav-item btn p-0"><a class="nav-link active" data-toggle="tab"
                                                            href="#priorities">{% translate "Priorities" %}</a></li>
                            <li class="nav-item btn p-0"><a class="nav-link" data-toggle="tab"
                                                            href="#climate">{% translate "Climate" %}</a></li>
                        </ul>

                        <div class="tab-content">
                            <div id="priorities" class="tab-pane active">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="card-body">
                                            {% include 'shared/priorities_table.html' %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="climate" class="tab-pane fade position-relative">
                                {% include 'climate/tabs/mapbox.html' %}
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

{% endblock %}

{% block javascript %}
    {{ block.super }}
    <!-- Attachments script for carrousel -->
    <script type="text/javascript">
        let spin_attachments_images = $("#spin-attachments-images");
        let attachments_images = $("#attachments_images");
        spin_attachments_images.show();
        attachments_images.html(`
    {% if images_data.exists_at_least_image %}

        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
                {% for image in images_data.images %}
                    <li data-target="#carouselExampleIndicators" data-slide-to="{{ forloop.counter }}"
            {% if image.url == images_data.first_image.url %}class="active"{% endif %} ></li>
                {% endfor %}
            </ol>
            <div class="carousel-inner">
                {% for image in images_data.images %}
                    <div class="carousel-item {% if image.url == images_data.first_image.url %}active{% endif %}">
                        <a href="{% url 'administrativelevels:village_attachments' object.id %}">
                            <img class="d-block w-100" src="{{ image.url|imgAWSS3Filter }}"
                            style="height: 500px !important;"
                            alt="{{ image.task }}">
                        </a>
                    </div>
                {% endfor %}
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>

    {% else %}
    <a href="{% url 'administrativelevels:village_attachments' object.id %}">
                <img class="card-img rounded" src="{% static 'images/village-image.jpg' %}"
    alt="Card image">
    </a>

    {% endif %}
    `);
        spin_attachments_images.hide();

    </script>
{% endblock %}